<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Valuing American and Real Options Through Least-Squares Monte Carlo Simulation</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Valuing American and Real Options Through Least-Squares Monte Carlo Simulation</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LSMRealOptions)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>The ‘LSMRealOptions’ package provides functions that apply the well-known least-squares Monte Carlo simulation (LSM) method to value American-style options; options with early exercise opportunities. LSM simulation was first presented in the study of Longstaff and Schwartz (2001) titled: “Valuing American Options by Simulation: A Simple Least-Squares Approach”. LSM simulation is a popular method for the approximation of the value of options with early-exercise and path dependent features due to its relative ease of use and ability to value options accurately under high dimension settings.</p>
<p>‘LSMRealOptions’ is designed to value American-style financial options and capital investment projects through real options analysis (ROA). ‘LSMRealOptions’ provides flexibility in the stochastic processes followed by underlying assets, the number of state variables, basis functions and general underlying asset characteristics to allow a broad range of assets to be valued through the LSM simulation method. ‘LSMRealOptions’ also allows for the consideration of operational flexibility in investment projects, allowing an invested project to temporarily suspend or permanently abandon operations.</p>
<p>The purpose of this vignette is to present worked examples of the functions available in the ‘LSMRealOptions’ package, with an emphasis on valuing capital investment projects through ROA, calculating critical values of investment, considering operational flexibility in investment projects and allowing for different stochastic assumptions in underlying assets. The remainder of this vignette is structured as follows. Section 2 presents the LSM Simulation method. Section 3 describes an application of the ‘LSM_american_option’ function to value vanilla American put options. Section 4 presents an application of the ‘LSM_real_option’ function to perform ROA on an arbitrary investment project example, subsequently allowing for temporary suspension and permanent abandonment in the investment project, with a brief discussion on how this has influenced investment decisions. Section 5 presents an algorithm to find the roots of the waiting option value, thus calculating critical values of underlying uncertainties at which immediate investment into a project is optimal. Section 6 presents several examples of valuing investment projects with differing assumptions in the processes and number of stochastic underlying variables.</p>
</div>
<div id="the-least-squares-monte-carlo-simulation-method" class="section level1">
<h1>2. The Least-Squares Monte Carlo Simulation Method:</h1>
<p>The LSM simulation method approximates the value of American-style options by discretising the dynamics of underlying assets using an Euler scheme, considering the early exercise of the option at discrete observation points. LSM simulation thus values Bermudan-style options, options where exercise is possible on specified exercise dates, with the value of these options approaching American option values as the discrete time step approaches zero.</p>
<p>The LSM simulation method solves for the value of American-style options through a backwards induction process, evaluating at each discrete time point the optimal decision between immediate exercise and payoff of the option and the discounted expected continuation value, calculated as the fitted values of a least-squares regression of basis functions. See Longstaff and Schwartz (2001) for more details and a worked example of the LSM simulation methods and backwards induction solution process.</p>
<p>The convergence properties of the LSM simulation function state that the American option value calculated by the LSM simulation method converges to the true value as the number of simulations and basis functions increase (Longstaff and Schwartz, 2001; Clément, Lamberton and Protter, 2002). LSM simulation can be a computationally expensive process, with processing times increasing as a function of the number of simulations used, the number of discrete time steps and the degree of the orthogonal polynomial that is applied.</p>
</div>
<div id="valuing-vanilla-american-put-options" class="section level1">
<h1>3. Valuing Vanilla American Put Options:</h1>
<p>An American put option gives the investor the right, but not necessarily the obligation, to sell a security at any time before option maturity. The following section presents the valuation of American put options through LSM simulation and the ‘LSM_american_option’ function. The put option examples presented follow those first presented in table 1 of Longstaff and Schwartz (2001).</p>
<div id="american-put-option-example" class="section level2">
<h2>3.1 American Put Option Example:</h2>
<p>Consider an American put option on a stock, with option expiry in 1 year and a strike price of $40. Assume the risk-free interest rate is .06. Furthermore, consider 10,000 simulations (of which 50% are antithetic) and an exercise opportunity of 50 times per year.</p>
<p>The stock price is assumed to follow a geometric Brownian motion (GBM) process that grows at the risk free rate with an initial price of $36 and an instantaneous volatility of 20%. The first step in the LSM simulation method is to simulate the state variable (the stock price) through Monte Carlo simulation. GBM processes can be simulated through the ‘GBM_simulate’ function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 - Simulate stock prices:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>stock_prices <span class="ot">&lt;-</span> <span class="fu">GBM_simulate</span>(<span class="at">n =</span> <span class="fl">1e4</span>, <span class="at">t =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="fl">0.06</span>, <span class="at">sigma =</span> <span class="fl">0.2</span>, <span class="at">S0 =</span> <span class="dv">36</span>, <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>)</span></code></pre></div>
<p>This example has considered only 10,000 simulated price paths, however more price paths to ensure the American-style option value converges is recommended. The computational time of the LSM simulation method increases as the number of simulated price paths are considered. The convergence of the calculated value can be evaluated by considering the standard error of the option value.</p>
<p>LSM simulation can be used to value the American put option using simulated state variables. Because there is only one state variable (the stock price) the argument for ‘state_variables’ and ‘payoff’ in the ‘LSM_american_option’ function are identical.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2 - Value American put option:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>put_option_value <span class="ot">&lt;-</span> <span class="fu">LSM_american_option</span>(<span class="at">state_variables =</span> stock_prices,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">payoff =</span> stock_prices,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">K =</span> <span class="dv">40</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">rf =</span> <span class="fl">0.06</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">unlist</span>(put_option_value[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]),<span class="dv">4</span>))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Value       Standard Error      Expected Timing </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               4.4641               0.0299               0.3684 </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Expected Timing SE Exercise Probability </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               0.0032               0.7385</span></span></code></pre></div>
<p>when argument ‘verbose’ is set to ‘TRUE’, additional information is returned by the ‘LSM_american_option’ function, as shown above.</p>
</div>
<div id="american-call-option-on-the-maximum-of-two-assets" class="section level2">
<h2>3.2 American call option on the maximum of two assets:</h2>
<p>More exotic American-style options can be valued through the ‘LSM_american_option’ function. Consider an American-style call option on the maximum price of two assets, with exercise opportunities 50 times per year and an option expiry of 1 year.</p>
<p>Let the two assets follow a GBM process, and for simplicity assume that their pricing developments are independent. Both are considered to grow at the risk free rate (.06) with instantaneous volatilities of .2 and .3 respectively. The initial prices of the assets are $38 and $35 respectively. The strike price of the option is $40.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 - Simulate asset prices:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>asset_prices <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">51</span>, <span class="fl">1e3</span>, <span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="dv">2</span>)) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  asset_prices[,,i] <span class="ot">&lt;-</span> <span class="fu">GBM_simulate</span>(<span class="at">n =</span> <span class="fl">1e3</span>, <span class="at">t =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="fl">0.06</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>)[i], <span class="at">S0 =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">35</span>)[i], <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>)}</span></code></pre></div>
<p>Simulated asset prices are provided as the underlying stochastically evolving state variables, and the maximum of the two asset prices are provided as the payoff at time <span class="math inline">\(t\)</span> for price path <span class="math inline">\(i\)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2 - Value American-style option:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>OptionValue <span class="ot">&lt;-</span> <span class="fu">LSM_american_option</span>(<span class="at">state_variables =</span> asset_prices,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">payoff =</span> <span class="fu">pmax</span>(asset_prices[,,<span class="dv">1</span>], asset_prices[,,<span class="dv">2</span>]),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">K =</span> <span class="dv">40</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">dt =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">rf =</span> <span class="fl">0.06</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cross_product =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">orthogonal =</span> <span class="st">&quot;Laguerre&quot;</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">degree =</span> <span class="dv">9</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">unlist</span>(OptionValue[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]),<span class="dv">4</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Value       Standard Error      Expected Timing </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               2.5478               0.0570               0.1976 </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Expected Timing SE Exercise Probability </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               0.0080               0.7750</span></span></code></pre></div>
<p>The basis functions used in the least-squares approximation in the scenario are the two asset prices, the first 9 degrees of the ‘Laguerre’ orthogonal polynomial of both of these asset prices and the cross product of the asset prices.</p>
</div>
<div id="replicate-table-1-of-longstaff-and-schwartz-2001" class="section level2">
<h2>3.3 Replicate table 1 of Longstaff and Schwartz (2001):</h2>
<p>The work of Longstaff and Schwartz (2001) presents a table of calculated vanilla American put option values under differing levels of strike prices, annual volatility of the underlying asset and option maturity (table 1). The corresponding calculated values under the LSM simulation method through the ‘LSM_american_option’ function are presented below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Exercise opportunities per year:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">50</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## strike price :</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## short-term interest rate:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fl">0.06</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 100,000 simulations (50% antithetic):</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Stock price volatility:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.2</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="fl">0.4</span>,<span class="dv">2</span>)),<span class="dv">5</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Stock price:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>S0 <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">36</span>,<span class="dv">44</span>,<span class="dv">2</span>),<span class="dv">4</span>))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Option maturity:</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>TTM <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>LSM_output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">2</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">&quot;Simulated American&quot;</span>, <span class="st">&quot;(s.e)&quot;</span>)))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Cycle through the rows of the table:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>simulated_values <span class="ot">&lt;-</span> <span class="fu">GBM_simulate</span>(<span class="at">n =</span> n_simulations, <span class="at">t =</span> TTM[i], </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mu =</span> rf, <span class="at">sigma =</span> sigma[i], <span class="at">S0 =</span> S0[i], <span class="at">dt =</span> dt)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="do">## American option pricing through LSM Simulation</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">LSM_american_option</span>(<span class="at">state_variables =</span> simulated_values,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">payoff =</span> simulated_values,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">call =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">K =</span> K,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dt =</span> dt,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rf =</span> rf,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">orthogonal =</span> <span class="st">&quot;Laguerre&quot;</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">degree =</span> <span class="dv">3</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>LSM_output[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> output<span class="sc">$</span>Value</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>LSM_output[i,<span class="dv">2</span>]  <span class="ot">&lt;-</span> output<span class="sc">$</span><span class="st">`</span><span class="at">Standard Error</span><span class="st">`</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Compile and print results:</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>LnS_table1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="at">S =</span> S0, <span class="at">sigma =</span> sigma, <span class="at">T =</span> TTM, LSM_output)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(LnS_table1,<span class="dv">3</span>))</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     S sigma T Simulated American (s.e)</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  36   0.2 1              4.474 0.009</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  36   0.2 2              4.831 0.011</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  36   0.4 1              7.081 0.019</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  36   0.4 2              8.480 0.022</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  38   0.2 1              3.242 0.009</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  38   0.2 2              3.746 0.011</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  38   0.4 1              6.141 0.018</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  38   0.4 2              7.647 0.022</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  40   0.2 1              2.319 0.009</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 40   0.2 2              2.875 0.011</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 40   0.4 1              5.318 0.018</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 40   0.4 2              6.912 0.022</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 42   0.2 1              1.615 0.008</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 42   0.2 2              2.216 0.010</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 42   0.4 1              4.586 0.017</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16 42   0.4 2              6.241 0.021</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 44   0.2 1              1.100 0.006</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 44   0.2 2              1.678 0.009</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19 44   0.4 1              3.942 0.016</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20 44   0.4 2              5.642 0.021</span></span></code></pre></div>
<p>As stated by Longstaff and Schwartz (2001), the first three Laguerre polynomials (i.e. degree = 3) is sufficient to obtain effective convergence of the algorithm in this scenario. Approximation of American option values are dependent on the number of basis functions used, the number of simulations and the size of the discrete time step of observations.</p>
</div>
</div>
<div id="real-options-analysis---valuing-capital-investment-projects" class="section level1">
<h1>4. Real Options Analysis - Valuing Capital Investment Projects:</h1>
<p>Real options analysis is generally more difficult than valuing American call or put options on assets such as stocks for several reasons. The time to expiration during real options analysis is generally far longer than that on securities, often spanning into decades of forecasting, which can greatly increase the spread of simulated price paths. Real options analysis often features case specific or path dependent characteristics of investment, increasing the complexity of the analysis required. Finally, multiple stochastic underlying assets can impact the cash flows resulting from investment, increasing the dimensionality of the option valuation problem. The LSM simulation method is able to consider each of these aspects of the investment problem.</p>
<p>The LSM simulation method evaluates investment under stochastic price uncertainty, determining at each time point the optimal investment decision between immediate investment, exercising the right to all future cash flows at a price of the initial investment cost, or to delay investment.</p>
<div id="example-1---project-value-of-one-underlying-asset" class="section level2">
<h2>4.1 Example 1 - Project Value Of One Underlying Asset:</h2>
<p>The following example is a relatively simple, arbitrary scenario of consideration into a capital investment project, evaluating the value of the option to invest through real options analysis. Real options analysis is performed through the ‘LSM_real_options’ function, and treats investment as an optimal stopping problem.</p>
<p>The following example considers a capital investment project, where operating costs of the project are fixed, but revenues are dependent upon a stochastically evolving underlying asset that follows a GBM process. The project can be invested at the beginning of each month (i.e. dt = 1/12) of the year. Cash flows are delivered at the end of each month. There is a construction time of 6 months considered in this investment project, which means there is 6 months between the initial capital investment and when net cash flows of the project are accrued. The initial capital investment cost also decreases exponentially at a rate of 1% p.a. to allow research and development into the project to reduce the cost of investment.</p>
<p>The cash flows accrued at each discrete time point <span class="math inline">\(t\)</span> are dependent upon the simulated stochastic price paths. We assume that there are variable and fixed cash flows in this investment project:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 - Simulate the underlying asset price:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial underlying price:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>initial_price <span class="ot">&lt;-</span> <span class="dv">36</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## discrete time step:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Project lifetime (in years):</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>project_lifetime <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>forecasting_periods <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, project_lifetime, dt)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>revenue_prices <span class="ot">&lt;-</span> <span class="fu">GBM_simulate</span>(<span class="at">n =</span> <span class="fl">1e3</span>, <span class="at">t =</span> project_lifetime, <span class="at">mu =</span> <span class="fl">0.06</span>, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma =</span> <span class="fl">0.2</span>, <span class="at">S0 =</span> initial_price, <span class="at">dt =</span> dt)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2 - Evaluate cash flows:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Fixed cash flow:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>FCF <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="sc">*</span> initial_price</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Net cash flow is equal to variable cash flows subtract fixed cash flows:</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>NCF <span class="ot">&lt;-</span> (<span class="fl">1e4</span> <span class="sc">*</span> revenue_prices <span class="sc">-</span> FCF) <span class="sc">*</span> dt</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Financial Parameters:</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>construction <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">/</span> dt</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial capital investment:</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>CAPEX <span class="ot">&lt;-</span> <span class="fl">1e5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> learning_rate <span class="sc">*</span> dt <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(revenue_prices)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3 - Evaluate Project Value through Real Options Analysis:</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>project_value <span class="ot">&lt;-</span> <span class="fu">LSM_real_option</span>(<span class="at">state_variables =</span> revenue_prices,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">NCF =</span> NCF,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CAPEX =</span> CAPEX,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dt =</span> dt,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                              <span class="at">rf =</span> rf,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                              <span class="at">construction =</span> construction,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">unlist</span>(project_value[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]), <span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>))</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ROV          NPV          WOV       ROV SE       NPV SE       WOV SE </span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;960,143.39&quot; &quot;849,943.19&quot; &quot;110,200.19&quot; &quot; 41,824.31&quot; &quot; 46,173.68&quot; &quot; 12,536.47&quot;</span></span></code></pre></div>
<p>The ‘ROV’ is also often referred to as the real option net present value (RO NPV) and is the average discounted payoffs of each price path when investment is exercised at the optimal time calculated through the backward induction process. The NPV is the average of the discounted payoffs considering immediate investment and is a numeric approximation of the standard NPV approach. The ‘WOV’ is the waiting option value, which is the difference between the ‘ROV’ and the ‘NPV’. The ‘WOV’ is considered the value of the option to delay initial investment, allowing for future uncertainty in price paths to reveal themselves. When the ‘WOV’ is greater than zero, the optimal investment decision is to delay investment, as immediate investment would result in the loss of the ‘WOV’.</p>
</div>
<div id="example-2---project-value-of-one-underlying-asset-with-operational-flexibility" class="section level2">
<h2>4.2 Example 2 - Project Value Of One Underlying Asset With operational Flexibility:</h2>
<p>The following example expands the investment scenario of section 4.1 by further allowing for the investment project to consider operational flexibility after investment into the project has occurred.</p>
<p>Consider the capital investment project of example 1. Assume that it now can be temporarily suspended at a cost of 30% of the initial capital investment cost. Whilst suspended, it accrues annual costs of 5% of the initial capital investment to keep the project “mothballed”. Restarting the operations takes 10% of the initial investment and abandoning the project costs 50% of the initial capital investment to decommission equipment, pay severance to existing workers, etc.</p>
<p>Operational flexibilities are path dependent problems and greatly increase the computational complexity of the LSM simulation function, resulting in slower processing times:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Evaluate Project Value with OF through ROA:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>project_value_OF <span class="ot">&lt;-</span> <span class="fu">LSM_real_option_OF</span>(<span class="at">state_variables =</span> revenue_prices,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">NCF =</span> NCF,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CAPEX =</span> CAPEX,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dt =</span> dt,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">rf =</span> rf,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">construction =</span> construction,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">suspend_CAPEX =</span> <span class="fl">0.1</span> <span class="sc">*</span> CAPEX[<span class="dv">1</span>],</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">suspend_OPEX =</span> <span class="fl">0.05</span> <span class="sc">*</span> CAPEX[<span class="dv">1</span>] <span class="sc">*</span> dt,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">resume_CAPEX =</span> <span class="fl">0.1</span> <span class="sc">*</span> CAPEX[<span class="dv">1</span>],</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">abandon_CAPEX =</span> <span class="fl">0.2</span> <span class="sc">*</span> CAPEX[<span class="dv">1</span>],</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">save_states =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">debugging =</span> <span class="cn">TRUE</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">unlist</span>(project_value_OF[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]), <span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             ROV          NPV OF             NPV             WOV          ROV SE </span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;  969,810.955&quot; &quot;1,009,195.762&quot; &quot;  860,900.341&quot; &quot;  -39,384.807&quot; &quot;   41,784.039&quot; </span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          NPV SE          WOV SE </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;   41,507.506&quot; &quot;    5,974.442&quot;</span></span></code></pre></div>
<p>Allowing for operational flexibility has increased both the ROV and the NPV of a project that can suspend, resume and shut down. The waiting option value is now negative, meaning that contrary to example 1, the optimal decision is to invest immediately. This has shown that allowing for additional assumptions and flexibility into the investment project can lead to different investment decisions.</p>
</div>
<div id="plot-the-cumulative-probability-of-investment" class="section level2">
<h2>4.3 Plot the cumulative probability of investment:</h2>
<p>The cumulative proportion of invested paths is returned by the ‘LSM_real_option’ and ‘LSM_real_option_OF’ functions when ‘verbose = TRUE’.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(forecasting_periods, <span class="fu">cbind</span>(project_value<span class="sc">$</span><span class="st">`</span><span class="at">Cumulative Investment Prob</span><span class="st">`</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>        project_value_OF<span class="sc">$</span><span class="st">`</span><span class="at">Cumulative Investment Prob</span><span class="st">`</span>), <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Forecasting Horizon&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative Investment Proportion&quot;</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Cumulative Investment Prop. over Forecasting Horizon&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;ROV&quot;</span>, <span class="st">&quot;ROV + OF&quot;</span>),<span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The proportion of invested paths is higher when considering operational flexibility due to the addition to the project value resulting from the options to suspend and abandon operations.</p>
</div>
<div id="plot-the-operating-states-of-the-investment-project" class="section level2">
<h2>4.3 Plot the Operating States of the Investment Project:</h2>
<p>The proportion of simulated price paths in each available operating state at each discrete time point is returned by the ‘LSM_real_option_OF’ function when ‘save_states = TRUE’. These states can be plotted using the package ‘ggplot2’ (Wickham, 2009):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>states_list <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">matrix</span>(<span class="fu">colnames</span>(project_value_OF<span class="sc">$</span><span class="st">`</span><span class="at">Project States</span><span class="st">`</span>)), <span class="dv">1</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">cbind.data.frame</span>(x, project_value_OF<span class="sc">$</span><span class="st">`</span><span class="at">Project States</span><span class="st">`</span>[,x], </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                                        forecasting_periods))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>states_ggplot <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(states_list))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>states_ggplot[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">factor</span>(states_ggplot[,<span class="dv">1</span>], <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">colnames</span>(project_value_OF<span class="sc">$</span><span class="st">`</span><span class="at">Project States</span><span class="st">`</span>)))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(states_ggplot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;count&quot;</span>, <span class="st">&quot;time&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(states_ggplot, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> count, <span class="at">fill =</span> state)) <span class="sc">+</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, project_lifetime, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">&quot;Proportion of Project States over Project Planning Horizon&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Planning Horizon (Years)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In general, the suspension operating state is less prolific as the residual lifetime of the investment project decreases, as the value of being suspended with the potential to resume operations becomes less valuable and suspended states may instead become abandoned. The abandonment and suspension operating states generally make up a low proportion of simulated operating states, with the cost of switching and maintaining the suspended state greatly influencing the propensity to suspend and abandon operations respectively. The additional value of the investment project when the cost of switching operating modes is equal to zero can be considered the upper limit to the added value of the investment project that considering operating flexibility can have.</p>
<p>The plot above could be an ideal result to present to the management of an investment project, as it can be interpreted as the likelihood of project success after initial investment has occurred. Project Managers are likely to be less inclined to consider investment projects that are shown to have a high possibility of being “mothballed” or abandoned at a net operating loss.</p>
</div>
<div id="real-options-analysis---calculating-investment-trigger-values" class="section level2">
<h2>5. Real Options Analysis - Calculating Investment Trigger Values:</h2>
<p>A key result of real options analysis is the ability to consider the critical “trigger” values of underlying, stochastically evolving assets at which immediate investment into the project is the optimal decision. Investment trigger values can be calculated by finding the root of the WOV of an investment project, i.e. the value of the state variable that results in the WOV of an investment project being approximately equal to zero, indicating that immediate investment into the project is the optimal investment decision at time <span class="math inline">\(t=0\)</span>. This can be effectively calculated by recursively running the ‘LSM.OptionValue’ function for different initial values of the state variable until the root of the WOV is found. The secant method is a root-finding algorithm that is functionally a finite-difference approximation of the well known Newton’s method that can efficiently converge to the root of the WOV. The secant recurrence relation is:</p>
<p><span class="math display">\[x_n = x_{n-1} - f(x_{n-1})\frac{x_{n-1}. - x_{n-2}}{f(x_{n-1}) - f(x_{n-2})} \]</span> The critical value of the project according to the NPV criterion (i.e. the critical value where <span class="math inline">\(NPV=0\)</span>) of the project can generally be calculated after 2 iterations as it is a linear function of the starting price.</p>
<p>The following section provides a worked solution of obtaining the critical trigger values of investment for the example presented in section 4.1:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate iterations:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>it <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>current_price <span class="ot">&lt;-</span> initial_price</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Begin Investment Trigger Value Calculate:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span>{</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1: Calculate the ROV using real options analysis</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  LSM_results <span class="ot">&lt;-</span> <span class="fu">LSM_real_option</span>(<span class="at">state_variables =</span> revenue_prices,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NCF =</span> NCF,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">CAPEX =</span> CAPEX,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dt =</span> dt,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rf =</span> rf,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">construction =</span> construction)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  NPV <span class="ot">&lt;-</span> LSM_results<span class="sc">$</span>NPV</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  WOV <span class="ot">&lt;-</span> LSM_results<span class="sc">$</span>WOV</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2: Evaluate the next initial asset price through the &#39;secant&#39; method:</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For the first iteration, use an arbitrary initial price multiplier of 2</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(it <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    new_price <span class="ot">=</span> current_price <span class="sc">*</span> multiplier</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(it <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="do">## NPV - a linear function of initial prices, so we can find it exactly after two iterations:</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    NPV_gradient <span class="ot">=</span> (NPV <span class="sc">-</span> NPV_old) <span class="sc">/</span> (current_price <span class="sc">-</span> old_price)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    NPV_new_price <span class="ot">=</span> current_price <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">-</span> NPV)<span class="sc">/</span>NPV_gradient</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(it <span class="sc">==</span> <span class="dv">2</span>) NPV_crit_value <span class="ot">=</span> NPV_new_price     </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="do">## ROV -  Secant Method:</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    new_price <span class="ot">=</span> current_price <span class="sc">-</span> WOV <span class="sc">*</span> ((current_price <span class="sc">-</span> old_price) <span class="sc">/</span> (WOV <span class="sc">-</span> WOV_old))</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Which is a multiple of:</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="ot">=</span> new_price <span class="sc">/</span> current_price</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The WOV does not have to be exactly zero. Having it within a tolerance value </span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="do">## can be adequate and decrease processing time:</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    WOV_tolerance <span class="ot">&lt;-</span> <span class="fu">abs</span>(WOV) <span class="sc">&lt;</span> <span class="dv">100</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If the price is identical within one cent, this can be considered the critical value:</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    price_tolerance <span class="ot">&lt;-</span> <span class="fu">round</span>(new_price,<span class="dv">2</span>)<span class="sc">==</span><span class="fu">round</span>(current_price, <span class="dv">2</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If the underlying asset impacts costs, and the iteration has pushed the price of the asset</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="do">## below zero, it&#39;s never optimal to invest immediately:</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    negative_price <span class="ot">&lt;-</span> new_price <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Recursion break to ensure infinite loop does not occur:</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    loop_break <span class="ot">&lt;-</span> it <span class="sc">&gt;</span> <span class="dv">20</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Approximate the root of WOV to 2 significant figures:</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(price_tolerance <span class="sc">||</span> WOV_tolerance <span class="sc">||</span> negative_price <span class="sc">||</span> loop_break){</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      ROV_crit_value <span class="ot">=</span> new_price</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: Update values:</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Updating simulated prices:</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  revenue_prices <span class="ot">&lt;-</span> revenue_prices <span class="sc">*</span> multiplier</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Updating the NCF of each period:</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  NCF <span class="ot">&lt;-</span> (<span class="fl">1e4</span> <span class="sc">*</span> revenue_prices <span class="sc">-</span> FCF) <span class="sc">*</span> dt</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Updating values</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  old_price <span class="ot">&lt;-</span> current_price</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  current_price <span class="ot">&lt;-</span> new_price</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  WOV_old <span class="ot">&lt;-</span> WOV</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  NPV_old <span class="ot">&lt;-</span> NPV</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 4: Re-iterate:</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  it <span class="ot">&lt;-</span> it <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="at">NPV =</span> NPV_crit_value, <span class="at">ROV =</span> ROV_crit_value),<span class="dv">2</span>))</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   NPV   ROV </span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27.53 40.30</span></span></code></pre></div>
<p>The ‘ROV’ value considers the value of the option to delay investment over the ‘NPV’ value. The ‘ROV’ is always consequently greater than, or equal to, NPV. This also means that the critical value of investment under the ROV is always greater than that under the NPV criterion. Calculating critical values can be appealing because it is easy to interpret and communicate these results, it provides a clear signal for when investment should be triggered and finally the waiting option value (WOV) is generally calculated with a greater level of certainty (i.e. lower standard error) than the real option value or net present value, providing greater certainty in results when interpreting them through critical values (Aspinall et al., 2020).</p>
</div>
</div>
<div id="real-options-analysis---two-factor-stochastic-process" class="section level1">
<h1>6. Real Options Analysis - Two-Factor Stochastic Process:</h1>
<p>In this section, the application of the ‘LSM_real_options’ function to perform real options analysis on an oil investment is considered. The oil asset is assumed to follow the two-factor short-term/long-term stochastic process first presented in the prolific work of Schwartz and Smith (2000), simulated using the ‘NFCP’ package (Aspinall et al., 2021). A worked example of evaluating real option value and trigger prices of investment is presented.</p>
<div id="the-two-factor-stochastic-process" class="section level2">
<h2>6.1 The Two-factor stochastic process:</h2>
<p>The two-factor stochastic model first presented by Schwartz and Smith (2000) decomposes the logarithm of the spot price of oil into the sum of two correlated underlying state variables: short-term deviations and long-run equilibrium prices.</p>
<p><span class="math display">\[S_t = exp(x_{1,t} + x_{2,t})\]</span> Where:</p>
<p><span class="math display">\[dx_{1,t} = \mu^*dt + \sigma_{1} dw_{1}t \]</span></p>
<p><span class="math display">\[ dx_{2,t} = - (\lambda_{2} + \kappa_{2}x_{2,t})dt + \sigma_{2} dw_{2}t \]</span></p>
<p>Where the first factor is a Brownian motion representing long-run changes to the equilibrium of oil prices, and the second factor is an Ornstein-Uhlenbeck process representing short-term deviations from this equilibrium, typically driven through supply and demand. The intuition behind this model is that over time deviations between the two-factors will tend towards zero. The ability of the model to explain the price behavior of commodities is well documented (Schwartz and Smith, 2000; Aspinall et al, 2020).</p>
<p>Simulating the two-factor stochastic process is available through the ‘NFCP’ package (Aspinall et al., 2021). This package allows the spot price of a commodity to follow N correlated factors (with the two-factor model being a special case of this framework). See the relevant documentation of this ‘NFCP’ for more details of N-factor (and the 2-factor) models.</p>
<p>Consider a proposed investment project where the revenue of this project is dependent upon current oil prices, where oil is assumed to follow a two-factor stochastic process. The two-factor model parameters used are:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(NFCP<span class="sc">::</span>SS_oil<span class="sc">$</span>two_factor[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    mu_rn lambda_2  kappa_2  sigma_1  sigma_2  rho_1_2 </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.0115   0.1570   1.4900   0.1450   0.2860   0.3000</span></span></code></pre></div>
<p>Assume that the initial price of oil is $60/bbl USD. Further assume that short-term deviations are at zero.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 - List project parameters:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Price:</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>initial_oil_price <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial State vector:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>initial_state_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(initial_oil_price), <span class="dv">0</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">## discrete time step:</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Project lifetime (in years):</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>project_lifetime <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>forecasting_periods <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, project_lifetime, dt)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Financial Parameters:</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Capital investment:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>CAPEX <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Fixed cash flow:</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>FCF <span class="ot">&lt;-</span> <span class="fl">5e4</span> <span class="sc">*</span> initial_oil_price</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction - 6 months:</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>construction <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">/</span> dt</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Risk-free interest rate:</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 - Simulate spot prices:</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 10,000 antithetic simulations of one year of monthly observations</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>simulated_oil_prices <span class="ot">&lt;-</span> NFCP<span class="sc">::</span><span class="fu">spot_price_simulate</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_0 =</span> initial_state_vector,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> NFCP<span class="sc">::</span>SS_oil<span class="sc">$</span>two_factor,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="dv">10</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">dt =</span> dt,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_simulations =</span> <span class="fl">1e4</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">antithetic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>oil_revenue <span class="ot">&lt;-</span> simulated_oil_prices<span class="sc">$</span>spot_prices</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>state_variables <span class="ot">=</span> <span class="fu">array</span>(<span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">dim</span>(simulated_oil_prices<span class="sc">$</span>spot_prices), <span class="dv">3</span>))</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>state_variables[,,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">=</span> simulated_oil_prices<span class="sc">$</span>state_variables</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Include the price as a state variable:</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>state_variables[,,<span class="dv">3</span>] <span class="ot">=</span> simulated_oil_prices<span class="sc">$</span>spot_prices</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Net cash flow of simulated price paths:</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>NCF <span class="ot">&lt;-</span> (<span class="fl">1e5</span> <span class="sc">*</span> oil_revenue <span class="sc">-</span> FCF) <span class="sc">*</span> dt</span></code></pre></div>
<p>The basis functions used in this example are the state variables, the first 9 of the Laugerre orthogonal polynomial for each state variable, their exponential sum (i.e. the price), and the cross products of state variables.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>project_value <span class="ot">&lt;-</span> <span class="fu">LSM_real_option</span>(<span class="at">state_variables =</span> state_variables,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">NCF =</span> NCF,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CAPEX =</span> CAPEX,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dt =</span> dt,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">rf =</span> rf,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">construction =</span> construction,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">orthogonal =</span> <span class="st">&quot;Laguerre&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">degree =</span> <span class="dv">9</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> T)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">unlist</span>(project_value[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]),<span class="dv">2</span>), <span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             ROV             NPV             WOV          ROV SE          NPV SE </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;21,115,992.58&quot; &quot;23,545,078.96&quot; &quot;-2,429,086.39&quot; &quot;   160,794.46&quot; &quot;   138,624.82&quot; </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          WOV SE </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;    39,868.99&quot;</span></span></code></pre></div>
<p>According to the real option analysis, this project should be invested immediately.</p>
<p>The calculation of critical values of the underlying, stochastically evolving, asset is possible through the iterative procedure presented in section 5. Under consideration of a two-factor (and the more general N-factor) model, finding the critical value of factor 1 (i.e. the equilibrium value) of the asset would provide the critical equilibrium price at which immediate investment is optimal, rather than the price itself. This could have the potential to avoid investment in a project as a result of price fluctuations that are not expected to persist passing above the critical value of investment.</p>
<p>The ‘LSM_real_option’ was easily able to consider a two-factor stochastic process. Other exotic stochastic processes, such as jump-diffusion stochastic processes as well as considering multiple stochastic underlying uncertainties can be considered throughout the ‘LSMRealOptions’ package provided they are first simulated through Monte Carlo methods.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References:</h1>
<p>Schwartz, E. S., and J. E. Smith, (2000). Short-Term Variations and Long-Term Dynamics in Commodity Prices. Manage. Sci., 46, 893-911.</p>
<p>Longstaff, F. A., and E. S. Schwartz, (2001). Valuing American options by simulation: a simple least-squares approach. The review of financial studies, 14(1), 113-147.</p>
<p>Clément, E., D. Lamberton, and P. Protter, (2002). An analysis of a least-squares regression method for American option pricing. Finance and stochastics, 6(4), 449-471.</p>
<p>Wickham, H. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2009.</p>
<p>Aspinall, T., A. Gepp, G. Harris, S. Kelly, C. Southam, and B. Vanstone, (2020). Estimation of a term structure model of carbon prices through state space methods: The European Union emissions trading scheme. Accounting &amp; Finance.</p>
<p>Aspinall, T., A. Gepp, G. Harris, S. Kelly, C. Southam, and B. Vanstone, (2020). NFCP: N-Factor Commodity Pricing Through Term Structure Estimation. R package version 0.1.0. <a href="https://CRAN.R-project.org/package=NFCP" class="uri">https://CRAN.R-project.org/package=NFCP</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
